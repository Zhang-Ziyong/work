

## message_filter 测试用例

> 开发人员： @wuhuabo 测试人员： @wuhuabo

### 1. handleTransformableMsg 测试用例

> 功能描述： 根据输入的转换转换保留的消息

初始化转换缓存:1.06, 1.05, 1.04, 1.03, 1.02, 1.01, tolerance为0.05
| 编号 | 输入/动作                                    | 期望的输出/响应              | 实际情况 |
| ---- | -------------------------------------------- | ---------------------------- | -------- |
| 1    | 输入时间戳1.06 + tolerance | 没有符合的转换 | 符合     |
| 2    | 输入时间戳1.01 - tolerance | 没有符合的转换 | 符合     |
| 3    | 输入时间戳1.06 - tolerance - 0.01 | 找到符合的转换, 回调调用一次, 转换缓存1.05之后的被清除, 剩两个 | 符合     |

### 2. inputTransform 测试用例

> 功能描述： 根据输入的转换转换保留的消息

初始化消息缓存:1.06, 1.05, 1.04, 1.03, 1.02, 1.01, tolerance为0.05, transform缓存[0, 48)
| 编号 | 输入/动作                                    | 期望的输出/响应              | 实际情况 |
| ---- | -------------------------------------------- | ---------------------------- | -------- |
| 1    | 输入时间戳1.06 + tolerance | 转换缓存增加到49, 最前端的数据为最新输入的数据 | 符合     |
| 2    | 输入时间戳1.06 + tolerance + 0.1 | 转换缓存增加到50, 最前端的数据为最新输入的数据 | 符合     |
| 3    | 输入时间戳1.01 - tolerance + 0.2 | 转换缓存保持为50, 最尾端的数据为46, 47被丢弃 | 符合     |
| 4    | 输入时间戳1.06 - tolerance - 0.01 | 找到能转换的消息, 回调调用一次, 转换缓存只保留最新输入的一个 | 符合     |

### 3. getLatestTransform 测试用例

> 功能描述： 输入消息, 获取匹配的转换

初始化tolerance为2, cache为2, transform缓存[0, 50)
| 编号 | 输入/动作                                                              | 期望的输出/响应                                                         | 实际情况 |
| ---- | ---------------------------------------------------------------------- | ----------------------------------------------------------------------- | -------- |
| 1    | 输入时间戳50 + tolerance | 返回WaitForFeasible, 转换缓存保持为50, 输入的指针未被赋值 | 符合     |
| 2    | 输入时间戳41 - 0.1 | 返回CanTransform, 转换缓存41之后的被清除, 剩余数量为10, 输入的指针指向41 | 符合     |
| 3    | 输入时间戳41 - 0.1 | 返回CanTransform, 转换缓存保持为10, 输入的指针指向41 | 符合     |
| 4    | 输入时间戳50 + tolerance + cache | 返回OutOfCache, 转换缓存被清除, 输入的指针未被赋值 | 符合     |
| 5    | 输入时间戳50 + cache + 1 | 返回WaitForFeasible | 符合     |

### 3. handleMessage 测试用例

> 功能描述： 输入消息并处理

初始化tolerance为2, cache为3, transform缓存[50, 0), message缓存[49, 0)
| 编号 | 输入/动作                                                              | 期望的输出/响应                                                         | 实际情况 |
| ---- | ---------------------------------------------------------------------- | ----------------------------------------------------------------------- | -------- |
| 1    | 输入时间戳52 | 转换缓存保持为50, 没有匹配的转换所以回调没被调用, transform缓存最前端的数据为最新输入的数据 | 符合     |
| 2    | 输入时间戳51 | 转换缓存保持为50, 回调被调用一次, transform缓存最前端的数据为之前的数据,没被更新 | 符合     |